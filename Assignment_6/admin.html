<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Interface</title>
    <script>
        // Generate test values
        function generateTestProducts() {
            // Create a testProducts array to store product information
            const testProducts = [];

            // Add valid products to the array
            for (let i = 1; i <= 10; i++) {
                testProducts.push({
                    item_id: `item_${i}`,
                    description: `Item ${i}`,
                    image: `image_${i}.png`,
                    on_hand_quantity: Math.floor(Math.random() * 100),
                    price: (Math.random() * 100).toFixed(2),
                });
            }

            // Add invalid products (e.g. missing item_id, invalid on_hand_quantity, invalid price)
            testProducts.push({ description: 'Invalid Item', image: 'invalid.png', on_hand_quantity: 10, price: 50.00 });

            // Add empty array
            testProducts.push([]);

            // Add big array
            for (let i = 11; i <= 1000; i++) {
                testProducts.push({
                    item_id: `item_${i}`,
                    description: `Item ${i}`,
                    image: `image_${i}.png`,
                    on_hand_quantity: Math.floor(Math.random() * 100),
                    price: (Math.random() * 100).toFixed(2),
                });
            }

            return testProducts;
        }

        function generateTestSalesRecords() {
            const testSalesRecords = [];

            // Add valid sales_record
            for (let i = 1; i <= 10; i++) {
                const dateSold = new Date();
                dateSold.setHours(dateSold.getHours() - Math.floor(Math.random() * 120));
                testSalesRecords.push({
                    item_id: `item_${i}`,
                    customer_id: `customer_${i}`,
                    date_sold: dateSold.toISOString(),
                    quantity: Math.floor(Math.random() * 10),
                    price: (Math.random() * 100).toFixed(2),
                });
            }

            // Add empty array
            testSalesRecords.push([]);

            // Add invalid sales_record (e.g. invalid item_id, invalid price)
            testSalesRecords.push({ customer_id: 'customer_invalid', date_sold: new Date().toISOString(), quantity: 10, price: 50.00 });

            // Add sales within the last 24/48/72/96 hours
            for (let i = 11; i <= 14; i++) {
                const dateSold = new Date();
                dateSold.setHours(dateSold.getHours() - (i * 8));
                testSalesRecords.push({
                    item_id: `item_${i}`,
                    customer_id: `customer_${i}`,
                    date_sold: dateSold.toISOString(),
                    quantity: Math.floor(Math.random() * 10),
                    price: (Math.random() * 100).toFixed(2),
                });
            }

            return testSalesRecords;
        }

        // Test values
        const testItemIds = ["1234", "A1234", "P1234", ":SDFLJ", "a1234", "*"];
        const testDiscounts = [0, -99, 99, 20, -20, "-200", "550"];
        const testDynamics = [true, false, "asdf;la"];

        // Test products and sales_record arrays
        const testProducts = generateTestProducts();
        const testSalesRecords = generateTestSalesRecords();

        // Test function
        function testPricingModule() {
            testItemIds.forEach(itemId => {
                testProducts.forEach(products => {
                    testSalesRecords.forEach(sales_record => {
                        testDiscounts.forEach(discount => {
                            testDynamics.forEach(dynamic => {
                                try {
                                    set_price(itemId, products, sales_record, discount, dynamic);
                                    console.log(`Test passed for item_id: ${itemId}, discount: ${discount}, dynamic: ${dynamic}`);
                                } catch (error) {
                                    console.error(`Test failed for item_id: ${itemId}, discount: ${discount}, dynamic: ${dynamic} - Error: ${error.message}`);
                                }
                            });
                        });
                    });
                });
            });
        }

        testPricingModule();



        // Get form elements
        const admin-form = document.getElementById("admin-form");
        const itemIdInput = document.getElementById("item-id");
        const discountInput = document.getElementById("discount");
        const dynamicInput = document.getElementById("dynamic");

        // Handle form submission
        admin-form.addEventListener("submit", (event) => {
            event.preventDefault();

            // Get form values
            const itemId = itemIdInput.value;
            const discount = parseFloat(discountInput.value);
            const dynamic = dynamicInput.checked;

            // Call set_price function
            set_price(itemId, products, sales_record, discount, dynamic);
        });
    </script>
</head>
<body>
    <h1>Admin Interface</h1>
    <form id="admin-form">
        <label for="item-id">Item ID (use * for all):</label>
        <input type="text" id="item-id" required>
        <br>
        <label for="discount">Discount (-99 to 99):</label>
        <input type="number" id="discount" min="-99" max="99" required>
        <br>
        <label for="dynamic">Automatic Pricing:</label>
        <input type="checkbox" id="dynamic">
        <br>
        <button type="submit">Apply Discount</button>
    </form>
    <script src="admin.js"></script>
</body>
</html>